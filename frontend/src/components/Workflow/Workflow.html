<section class="workflow" data-component="workflow">
  <header class="workflow__header">
    <div class="workflow__titles">
      <h1>Centro de Control</h1>
      <p>Flujo de validaci√≥n y cumplimiento normativo automatizado.</p>
    </div>
    <div class="workflow__session">
      <span class="workflow__status-badge" data-doc-state-badge>Sin documento cargado</span>
      <button type="button" class="ghost-button" data-action="logout">Cerrar sesi√≥n</button>
    </div>
  </header>

  <div class="workflow__layout">
    <aside class="workflow__steps">
      <button type="button" class="workflow-step is-active" data-step-target="upload">
        <span>1</span>
        Subir documento
      </button>
      <button type="button" class="workflow-step" data-step-target="verify">
        <span>2</span>
        Verificar documento
      </button>
      <button type="button" class="workflow-step" data-step-target="chat">
        <span>3</span>
        Asistente IA
      </button>
      <button type="button" class="workflow-step" data-step-target="edit" style="display: none;">
        <span>4</span>
        Editar documento
      </button>
      <button type="button" class="workflow-step" data-step-target="report">
        <span>4</span>
        Resumen del documento
      </button>
    </aside>

    <div class="workflow__panels">
      <article class="workflow-panel is-active" data-panel="upload">
        <header>
          <h2>Cargar Documentos</h2>
          <p>Sube tus archivos para iniciar el an√°lisis inteligente.</p>
        </header>

        <form class="upload-form" data-upload-form>
          <div class="file-dropzone">
            <input type="file" name="file" id="file-upload" class="file-input" multiple accept=".pdf,.jpg,.png,.html" />
            <label for="file-upload" class="file-label">
              <div class="icon">üìÇ</div>
              <span class="text">Arrastra o selecciona archivos (Factura, Packing List...)</span>
              <span class="hint">Soporta PDF, Im√°genes y HTML</span>
            </label>
          </div>

          <div class="upload-form__grid">
            <label>
              <span>Tipo de documento</span>
              <select name="doc_type">
                <option value="">Seleccionar</option>
                <option value="factura_comercial">Factura comercial</option>
                <option value="packing_list">Packing list</option>
                <option value="bl">Bill of Lading</option>
                <option value="certificado_fitosanitario">Certificado Fitosanitario</option>
                <option value="certificado_origen">Certificado de Origen</option>
                <option value="dus">Declaraci√≥n Aduanera (DUS)</option>
                <option value="guia_despacho">Gu√≠a de Despacho</option>
              </select>
            </label>
            <label>
              <span>Idioma</span>
              <select name="language_hint">
                <option value="">Auto</option>
                <option value="es">Espa√±ol</option>
                <option value="en">Ingl√©s</option>
                <option value="pt">Portugu√©s</option>
              </select>
            </label>
          </div>
          <button type="submit" class="primary-button">Enviar al analizador</button>
        </form>

        <div class="camera-capture" data-camera-panel>
          <video autoplay playsinline muted data-camera-video></video>
          <div class="camera-capture__actions">
            <button type="button" class="primary-button" data-action="capture-photo">Usar esta foto</button>
            <button type="button" class="ghost-button" data-action="close-camera">Cancelar</button>
          </div>
          <p>Enfoca el documento completo antes de tomar la fotograf√≠a.</p>
          <canvas data-camera-canvas hidden></canvas>
        </div>

        <!-- Processing Log Overlay -->
        <div class="processing-log" data-processing-log hidden>
          <div class="processing-log__terminal">
            <div class="processing-log__header">
              <span class="dot red"></span>
              <span class="dot yellow"></span>
              <span class="dot green"></span>
              <span class="title">App_Inova AI Engine</span>
            </div>
            <div class="processing-log__content" data-log-content>
              <!-- Log lines will be injected here -->
            </div>
          </div>
        </div>

      </article>

      <article class="workflow-panel" data-panel="verify">
        <header>
          <h2>Verificar documento</h2>
          <p>Consulta metadatos, entidades detectadas y texto OCR para validar el contenido.</p>
        </header>
        
        <div class="split-view">
          <!-- Left Column: PDF Preview -->
          <div class="split-view__left">
            <div class="pdf-preview-wrapper" data-text-preview>
              <div style="padding: 2rem; text-align: center; color: var(--slate-400);">
                Sube un documento para ver la vista previa.
              </div>
            </div>
          </div>

          <!-- Right Column: Metadata & Validations -->
          <div class="split-view__right">
            
            <!-- Compact Metadata Bar -->
            <div class="meta-bar" data-doc-meta>
              <!-- Injected by JS -->
            </div>

            <!-- Validations -->
            <section class="panel-card">
              <header>
                <h3>Validaciones</h3>
              </header>
              <ul class="signals-list" data-doc-signals></ul>
            </section>

            <!-- Suggestions -->
            <section class="panel-card">
              <header>
                <h3>Sugerencias</h3>
              </header>
              <ul class="signals-list" data-suggestion-list></ul>
            </section>

            <!-- Entities & Keywords -->
            <section class="panel-card">
              <header>
                <h3>Entidades y Palabras Clave</h3>
              </header>
              <ul class="entity-table" data-entity-list></ul>
              <div class="tag-cloud" data-keyword-chips style="margin-top: 1rem;"></div>
            </section>
            
            <!-- Spellcheck (Hidden if empty usually, but good to have) -->
             <section class="panel-card" data-spell-panel hidden>
              <header>
                <h3>Ortograf√≠a</h3>
              </header>
              <ul class="signals-list" data-spell-list></ul>
            </section>

          </div>
        </div>
      </article>

      <article class="workflow-panel" data-panel="chat">
        <header>
          <h2>Asistente IA</h2>
          <p>Interact√∫a con el documento para extraer informaci√≥n espec√≠fica o aclarar dudas.</p>
        </header>
        <div class="chat-interface">
          <div class="chat-messages" data-chat-messages>
            <div class="chat-message system">
              <div class="avatar">AI</div>
              <div class="content">Hola, soy tu asistente documental. Preg√∫ntame sobre el peso, el exportador, o si hay
                errores en el documento.</div>
            </div>
          </div>
          <form class="chat-input" data-chat-form>
            <input type="text" name="query" placeholder="Escribe tu pregunta aqu√≠..." autocomplete="off" />
            <button type="submit" class="primary-button">Enviar</button>
          </form>
        </div>
      </article>

      <article class="workflow-panel" data-panel="edit">
        <header>
          <h2>Editar documento</h2>
          <p>Selecciona ajustes autom√°ticos para corregir formatos y cumplir con el checklist.</p>
        </header>
        <div class="panel-card panel-card--wide">
          <header>
            <h3>Opciones de ajuste</h3>
          </header>
          <form class="auto-options" data-auto-options>
            <label>
              <input type="checkbox" name="normalize_amounts" value="true" checked />
              Normalizar montos a formato 12 345,67 ‚ûú 12345.67
            </label>
            <label>
              <input type="checkbox" name="ensure_incoterm" value="true" checked />
              Confirmar que el INCOTERM aparezca en cabecera y pie de p√°gina
            </label>
            <label>
              <input type="checkbox" name="flag_missing_fields" value="true" />
              Se√±alar campos obligatorios vac√≠os (n√∫mero de contenedor, BL, HS Code)
            </label>
            <label>
              <input type="checkbox" name="language_consistency" value="true" />
              Unificar idioma a espa√±ol para mensajes del cliente
            </label>
          </form>
          <div class="auto-actions">
            <button type="button" class="primary-button" data-action="apply-fixes">Aplicar ajustes autom√°ticos</button>
            <span class="auto-status" data-auto-status>Sin ajustes generados todav√≠a.</span>
          </div>
          <div class="auto-result" data-auto-result></div>
        </div>
      </article>

      <article class="workflow-panel" data-panel="report">
        <header>
          <h2>Resumen del documento</h2>
          <p>Consolida hallazgos, riesgos y acciones autom√°ticas antes de compartir.</p>
        </header>
        <div class="panel-card panel-card--wide" data-summary-card>
          <p>Necesitas procesar un documento para generar el resumen.</p>
        </div>
        <div class="summary-actions">
          <a href="#" class="primary-button" data-action="download-report" target="_blank" style="text-decoration: none; display: inline-flex; align-items: center; justify-content: center;">Descargar informe (PDF)</a>
        </div>
      </article>
    </div>
  </div>
</section>